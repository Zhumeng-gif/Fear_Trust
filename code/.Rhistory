table(fullData$occR)
plot_inside <- fullData %>%
count(year,occR) %>%
drop_na() %>%
ggplot(aes(fill = occR, y = n, x = year)) +
geom_bar(position = "fill",stat = "identity")
plot_inside
scale_y_continuous(labels = scales::percent())
plot_inside <- fullData %>%
count(year,occR) %>%
drop_na() %>%
ggplot(aes(fill = occR, y = n, x = year)) +
geom_bar(position = "fill",stat = "identity") +
scale_y_continuous(labels = scales::percent())
plot_inside
ggsave(plot_inside,file = "../fig/plot_inside.pdf",width = 8)
names(fullData)
plot_trust <- fullData %>%
group_by(year,occR) %>%
summarise(politicalTrust = mean(trust_gover))
plot_trust
plot_trust <- fullData %>%
group_by(year,occR) %>%
summarise(politicalTrust = mean(trust_gover,na.rm = T))
plot_trust
summary(fullData$occR)
plot_trust <- fullData %>%
drop_na() %>%
group_by(year,occR) %>%
summarise(politicalTrust = mean(trust_gover,na.rm = T))
plot_trust
summary(fullData)
summary(fullData_omit$occR)
table(fullData_omit$occR)
table(fullData$occR)
plot_trust
plot_trust <- fullData %>%
group_by(year,occR) %>%
summarise(politicalTrust = mean(trust_gover,na.rm = T)) %>%
ggplot() +
geom_line(aes(year,politicalTrust))
plot_trust
plot_trust <- fullData %>%
group_by(year,occR) %>%
summarise(politicalTrust = mean(trust_gover,na.rm = T)) %>%
ggplot() +
geom_bar(aes(year,politicalTrust))
plot_trust
plot_inside <- fullData %>%
count(year,occR)
plot_inside
fullData %>%
count(year,occR) %>%
drop_na()
table(cbs2002$occR
)
fullData %>%
count(year,occR,trust_gover)
plot_trust <- fullData %>%
count(year,occR,trust_gover) %>%
as.data.frame()
plot_trust
plot_trust <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n)
plot_trust
plot_trustin <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
filter(occR = 1)
plot_trustin <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
filter(occR == 1)
plot_trustin
plot_trustin <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
filter(occR == 1) %>%
ggplot(aes(fill = trust_gover, y = n, x = year)) +
geom_bar(position = "fill",stat = "identity") +
labes(y = "Percentage of In/Out")
plot_trustin <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
filter(occR == 1) %>%
ggplot(aes(fill = trust_gover, y = n, x = year)) +
geom_bar(position = "fill",stat = "identity") +
labs(y = "Percentage of In/Out")
plot_trustin
plot_trustin <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
filter(occR == 1) %>%
ggplot(aes(fill = trust_gover, y = number, x = year)) +
geom_bar(position = "fill",stat = "identity") +
labs(y = "Percentage of In/Out")
plot_trustin
fullData$trust_gover <- as.factor(fullData$trust_gover)
plot_trustin <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
filter(occR == 1) %>%
ggplot(aes(fill = trust_gover, y = number, x = year)) +
geom_bar(position = "fill",stat = "identity") +
labs(y = "Percentage of In/Out")
plot_trustin
?ggassve
?ggsave
ggsave(plot_inside,file = "../fig/plot_inside.png",width = 8)
plot_trust_in <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
filter(occR == 1) %>%
ggplot(aes(fill = trust_gover, y = number, x = year)) +
geom_bar(position = "fill",stat = "identity") +
labs(y = "Political Trust Within the System")
ggsave(plot_inside,file = "../fig/plot_inside.png",width = 8)
ggsave(plot_inside,file = "../fig/plot_trust_in.png",width = 8)
ggsave(plot_trust_in,file = "../fig/plot_trust_in.png",width = 8)
plot_trust_out <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
filter(occR == 0) %>%
ggplot(aes(fill = trust_gover, y = number, x = year)) +
geom_bar(position = "fill",stat = "identity") +
labs(y = "Political Trust Without the System")
plot_trust_out
plot_trust_out <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
filter(occR == 0)
plot_trust_out
plot_trust_out <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
ggplot(aes(fill = trust_gover, y = number, x = year)) +
facet_wrap(~ occR) +
geom_bar(position = "fill",stat = "identity") +
labs(y = "Political Trust Without the System")
plot_trust_out
plot_trust <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
ggplot(aes(fill = trust_gover, y = number, x = year)) +
facet_wrap(~ occR) +
geom_bar(position = "fill",stat = "identity") +
labs(y = "Political Trust Within/Out the System")
plot_trust
fullData <- bind_rows(
df_cbs2002,
df_cbs2014,
df_cbs2019,
df_cgss2010,
df_pku2008,
df_pku2009,
df_css2006,
df_css2017
)
fullData$occR <- as.factor(fullData$occR)
fullData$year <- as.factor(fullData$year)
fullData$trust_gover <- as.factor(fullData$trust_gover)
plot_within <- fullData %>%
count(year,occR) %>%
drop_na() %>%
ggplot(aes(fill = occR, y = n, x = year)) +
geom_bar(position = "fill",stat = "identity") +
labes(y = "Percentage of In/Out")
plot_within <- fullData %>%
count(year,occR) %>%
drop_na() %>%
ggplot(aes(fill = occR, y = n, x = year)) +
geom_bar(position = "fill",stat = "identity") +
labs(y = "Percentage of In/Out")
ggsave(plot_inside,file = "../fig/plot_within.phg",width = 8)
ggsave(plot_inside,file = "../fig/plot_within.png",width = 8)
ggsave(plot_within,file = "../fig/plot_within.png",width = 8)
plot_trust <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
ggplot(aes(fill = trust_gover, y = number, x = year)) +
facet_wrap(~ occR) +
geom_bar(position = "fill",stat = "identity") +
labs(y = "Political Trust Within/Out the System")
plot_trust
plot_trust_out <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
filter(occR == 0)
plot_trust_out <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
filter(occR == 0) %>%
ggplot(aes(fill = trust_gover, y = number, x = year)) +
geom_bar(position = "fill",stat = "identity") +
labs(y = "Political Trust Without the System")
ggsave(plot_trust_out,file = "../fig/plot_trust_out.png",width = 8)
plot_trust_in <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
filter(occR == 1) %>%
ggplot(aes(fill = trust_gover, y = number, x = year)) +
geom_bar(position = "fill",stat = "identity") +
labs(y = "Political Trust Without the System")
ggsave(plot_trust_in,file = "../fig/plot_trust_in.png",width = 8)
plot_trust_out
plot_trust_in
plot_trust <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
ggplot(aes(fill = trust_gover, y = number, x = year)) +
facet_wrap(~ occR) +
geom_bar(position = "fill",stat = "identity") +
labs(y = "Political Trust Within/Out the System")
ggsave(plot_trust,file = "../fig/plot_trust.png",width = 8)
plot_trust_in <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
filter(occR == 1) %>%
ggplot(aes(fill = trust_gover, y = number, x = year)) +
geom_bar(position = "fill",stat = "identity") +
labs(y = "Political Trust Within the System")
ggsave(plot_trust_out,file = "../fig/plot_trust_in.png",width = 8)
plot_trust_out
plot_trust_in
plot_trust
plot_within <- fullData %>%
count(year,occR) %>%
drop_na() %>%
ggplot(aes(fill = occR, y = n, x = year)) +
geom_bar(position = "fill",stat = "identity") +
scale_fill_manual(values =  rev(c('#B8860B','#FFFF00'))) +
labs(y = "Percentage of In/Out")
plot_within
plot_within <- fullData %>%
count(year,occR) %>%
drop_na() %>%
ggplot(aes(fill = occR, y = n, x = year)) +
geom_bar(position = "fill",stat = "identity") +
scale_fill_manual(values =  rev(c('#B8860B','#BDB76B'))) +
labs(y = "Percentage of In/Out")
plot_within
ggsave(plot_within,file = "../fig/plot_within.png",width = 8)
plot_trust <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
ggplot(aes(fill = trust_gover, y = number, x = year)) +
facet_wrap(~ occR) +
scale_fill_manual(values =  rev(c('#B8860B','#BDB76B'))) +
labs(y = "Political Trust Within/Out the System")
plot_trust
plot_trust <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
ggplot(aes(fill = trust_gover, y = number, x = year)) +
facet_wrap(~ occR) +
geom_col(position = 'stack', width = 0.6) +
scale_fill_manual(values =  rev(c('#B8860B','#BDB76B'))) +
labs(y = "Political Trust Within/Out the System")
plot_trust
plot_trust <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
ggplot(aes(fill = trust_gover, y = number, x = year)) +
facet_wrap(~ occR,scales = 'free_x') +
geom_col(position = 'stack', width = 0.6) +
scale_fill_manual(values =  rev(c('#B8860B','#BDB76B'))) +
labs(y = "Political Trust Within/Out the System")
plot_trust
plot_trust <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
ggplot(aes(fill = trust_gover, y = number, x = year)) +
facet_wrap(~ occR) +
geom_bar(position = "fill",stat = "identity") +
scale_fill_manual(values =  rev(c('#B8860B','#BDB76B'))) +
labs(y = "Political Trust Within/Out the System")
plot_trust
plot_trust <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
ggplot(aes(fill = trust_gover, y = number, x = year)) +
facet_wrap(~ occR) +
geom_bar(position = "fill",stat = "identity") +
scale_fill_manual(values =  rev(c('#B8860B','#BDB76B'))) +
geom_text(aes(label=number),
position = position_dodge2(width = 0.9, preserve = 'single'),
vjust = -0.2, hjust = 0.5)
plot_trust
table(fullData$trust_gover)
fullData %>%
group_by(year, occR) %>%
summarise(count = n())
fullData %>%
group_by(year, occR) %>%
summarise(count = n()) %>%
mutate(nmber = cumsum(count))
443+1186
fullData %>%
group_by(year, occR) %>%
summarise(count = n()) %>%
ggplot(aes(occR, count)) +
geom_col(aes(fill=trust_gover), position = position_stack(reverse = TRUE)) +
geom_text(aes(label = count),
position = position_stack(), # 可以不设置该参数
vjust = 0.5, hjust=0.5)
fullData %>%
group_by(year, occR) %>%
summarise(count = n()) %>%
ggplot(aes(occR, count)) +
geom_col(aes(fill=occR), position = position_stack(reverse = TRUE)) +
geom_text(aes(label = count),
position = position_stack(), # 可以不设置该参数
vjust = 0.5, hjust=0.5)
fullData %>%
group_by(year, occR) %>%
summarise(count = n()) %>%
drop_na() %>%
ggplot(aes(occR, count)) +
geom_col(aes(fill=occR), position = position_stack(reverse = TRUE)) +
geom_text(aes(label = count),
position = position_stack(), # 可以不设置该参数
vjust = 0.5, hjust=0.5)
plot_trust <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
ggplot(aes(fill = trust_gover, y = number, x = year)) +
facet_wrap(~ occR) +
geom_bar(position = "fill",stat = "identity") +
scale_fill_manual(values =  rev(c('#B8860B','#BDB76B'))) +
scale_fill_discrete(labels = c(
"No confidence",
"Confidence"
)) +
labs(y = "Political Trust Within/Out the System")
plot_trust
plot_trust <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
ggplot(aes(fill = trust_gover, y = number, x = year)) +
facet_wrap(~ occR) +
geom_bar(position = "fill",stat = "identity") +
scale_fill_manual(values =  rev(c('#B8860B','#BDB76B')),
labels = c(
"No confidence",
"Confidence")) +
labs(y = "Political Trust Within/Out the System")
plot_trust
plot_trust <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n) %>%
ggplot(aes(fill = trust_gover, y = number, x = year)) +
facet_wrap(~ occR) +
geom_bar(position = "fill",stat = "identity") +
scale_fill_manual(values =  rev(c('#B8860B','#BDB76B')),
labels = c("No confidence",
"Confidence")) +
scale_y_continuous(labels = scales::percent) +
labs(y = "Political Trust Within/Out the System")
plot_trust
ggsave(plot_trust,file = "../fig/plot_trust.png",width = 8)
plot_within <- fullData %>%
count(year,occR) %>%
drop_na() %>%
ggplot(aes(fill = occR, y = n, x = year)) +
geom_bar(position = "fill",stat = "identity") +
scale_fill_manual(values =  rev(c('#B8860B','#BDB76B'))) +
labs(y = "Percentage of In/Out")
plot_within
plot_within <- fullData %>%
count(year,occR) %>%
drop_na() %>%
ggplot(aes(fill = occR, y = n, x = year)) +
geom_bar(position = "fill",stat = "identity") +
scale_fill_manual(values =  rev(c('#B8860B','#BDB76B')),
labels = c("In the System",
"Out of System")) +
scale_y_continuous(labels = scales::percent) +
labs(y = "Percentage of In/Out")
plot_within
ggsave(plot_within,file = "../fig/plot_within.png",width = 8)
fullData %>%
count(year,occR) %>%
drop_na()
plot_within
within <- fullData %>%
count(year,occR) %>%
drop_na() %>%
as.data.frame() %>%
rename(n = number)
within <- fullData %>%
count(year,occR) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n)
write.csv(within, file = "../fig/with.csv")
trust_in <- fullData %>%
count(year,occR,trust_gover) %>%
drop_na() %>%
as.data.frame() %>%
rename(number = n)
write.csv(trust_in, file = "../fig/trust_in.csv")
set.seed(313)
name <- c("吴成彰",
"周宜晖",
"马玉琦",
"徐于涵",
"叶心怡",
"刘铭轩",
"王伽伊",
"黄筱烜",
"高熙展",
"王泽瑜"
)
group <-split(name,sample(rep(1:11,c(1,1,1,1,1,1,1,1,1,1,1))))
group <-split(name,sample(rep(1:11,c(1,1,1,1,1,1,1,1,1,1))))
group <-split(name,sample(rep(1:10,c(1,1,1,1,1,1,1,1,1,1))))
group
sample(name,2,replace = TRUE)
sample(name,2,replace = TRUE)
set.seed(1206)
options (warn = -1)
setwd("/Users/zhumeng/Desktop/project/Fear_Trust/code")
set.seed(1206)
options (warn = -1)
setwd("/Users/zhumeng/Desktop/project/Fear_Trust/code")
# packbirth loading
library(pacman)
p_load("rio",
"here",
"tidyverse",
"haven",
"car",
"modelsummary")
# no socilalevel
cbs2002_raw<- read_dta("../data/cbs/cbs2002.dta") %>%
mutate(year = 2002,
wave = 1)
cbs2002 <- cbs2002_raw %>%
select(.,q1,q2,province_id,v82,v83,v2,v84,v111,v110,v109,v101,v123,v130,v73b,v73c,year,wave)  %>%
rename(id = q1)
table(cbs2002$v110)
cbs2002$edu <- Recode(cbs2002$v110, "1 = 1; 2 = 2; 3:4 = 3; 5:6 = 4; 9 = NA")
table(cbs2002$edu)
set.seed(313)
name <- c("吴成彰",
"周宜晖",
"马玉琦",
"徐于涵",
"叶心怡",
"刘铭轩",
"王伽伊",
"黄筱烜",
"高熙展",
"王泽瑜"
)
group <-split(name,sample(rep(1:10,c(1,1,1,1,1,1,1,1,1,1))))
group
sample(name,2,replace = TRUE)
sample(name,2,replace = TRUE)
